insert into [dbo].[0 Workorder Asset Segments_daf] ([Sitid]      ,[Asset Segment Description]      ,[Asset Count (Default Descending Sort)]      --,'0' as [Total Segment Install Value]	  )select SITEID,Family, assetcountfrom(select  distinct aa.SITEID as siteid, CONCAT(aa.[AssetClass],'-',aa.[MANUFACTURERID],'-',aa.[MakeModel]) as Family,count( distinct aa.Assetnum)assetcount--2080 availablehrs,--'31-Mar-2022' as yearfrom [dbo].[PMO_3410012] aaleft join [dbo].client_workorder w on aa.assetnum=w.assetnum and w.year='31-Mar-2022' left join (select CONCAT(ase.[AssetClass],'-',ase.[MANUFACTURERID],'-',ase.[MakeModel])family,count(w.wonum)bdmwo,datediff(day,min(reportdate),max(reportdate))tbf from 	[dbo].client_workorder  w 		left join [dbo].[PMO_3410012]  ase on w.assetnum=ase.assetnum			where 			w.year='31-Mar-2022' 			group by CONCAT(ase.[AssetClass],'-',ase.[MANUFACTURERID],'-',ase.[MakeModel]))mc 			on mc.family=CONCAT(aa.[AssetClass],'-',aa.[MANUFACTURERID],'-',aa.[MakeModel])left join (select distinct RECORDKEY,RELATETYPE,count(distinct case when r.relatetype='FOLLOWUP' then r.relatedreckey end)RELATEDRECKEYfrom [dbo].[relatedrecord_ALL] r where RELATETYPE='FOLLOWUP' and year='31-Mar-2022'  group by RECORDKEY,RELATETYPE ) r on r.RECORDKEY=w.wonumwhere aa.siteid='daf' andaa.isflag in(0) group by CONCAT(aa.[AssetClass],'-',aa.[MANUFACTURERID],'-',aa.[MakeModel]),aa.siteid )korder by assetcount descselect * from [dbo].[0WorkorderAssetSegmentdrilldown]